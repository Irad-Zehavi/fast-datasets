# AUTOGENERATED! DO NOT EDIT! File to edit: ../nbs/pfr.ipynb.

# %% auto 0
__all__ = ['URL', 'PinterestFaces']

# %% ../nbs/pfr.ipynb 3
from fastai.vision.all import *

import fast_datasets.patches
from .utils import default_data_dir

# %% ../nbs/pfr.ipynb 4
URL = 'https://www.kaggle.com/datasets/hereisburak/pins-face-recognition'

def PinterestFaces():
    root = default_data_dir()/'105_classes_pins_dataset'
    assert root.exists(), f'Please manually download dataset from {URL} to {root}'
    dblock = DataBlock(
        blocks=(ImageBlock, CategoryBlock),
        get_items=get_image_files,
        get_y=lambda p: parent_label(p).replace('pins_', '').replace('_', ' ').title()
    )

    return dblock.datasets(root)
