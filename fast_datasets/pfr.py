# AUTOGENERATED! DO NOT EDIT! File to edit: ../nbs/pfr.ipynb.

# %% auto 0
__all__ = ['URL', 'ROOT', 'PinterestFaces']

# %% ../nbs/pfr.ipynb 3
from fastai.vision.all import *

import fast_datasets.patches
from .utils import data_path

# %% ../nbs/pfr.ipynb 4
URL = 'https://www.kaggle.com/datasets/hereisburak/pins-face-recognition'
ROOT = data_path()/'105_classes_pins_dataset'

def PinterestFaces():
    assert ROOT.exists(), f'Please manually download dataset from {URL} to {root}'
    dblock = DataBlock(
        blocks=(ImageBlock, CategoryBlock),
        get_items=get_image_files,
        get_y=lambda p: parent_label(p).replace('pins_', '').replace('_', ' ').title()
    )

    return dblock.datasets(ROOT)
